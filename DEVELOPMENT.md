# –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏: Ozon Analytics Assistant

> **–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫:** @first_seller (Telegram)
> **–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2026-02-05

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (–¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞)

### –ß—Ç–æ —ç—Ç–æ –∑–∞ –ø—Ä–æ–µ–∫—Ç?
Chrome-—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ + –±—ç–∫–µ–Ω–¥ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö Ozon —Å –ø–æ–º–æ—â—å—é Claude AI.

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
```
Chrome –ø–ª–∞–≥–∏–Ω ‚Üí –ù–∞—à —Å–µ—Ä–≤–µ—Ä (Node.js) ‚Üí Claude API
     ‚Üë              ‚Üì
     ‚îî‚îÄ‚îÄ PostgreSQL (–∏—Å—Ç–æ—Ä–∏—è, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –±–∏–ª–ª–∏–Ω–≥)
```

### –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏
1. **–ü—Ä–æ–∫—Å–∏-–º–æ–¥–µ–ª—å** ‚Äî –æ–¥–∏–Ω API –∫–ª—é—á Claude –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ, –∫–ª–∏–µ–Ω—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –Ω–∞—à–∏ –∫–ª—é—á–∏
2. **–ë–∏–ª–ª–∏–Ω–≥** ‚Äî –Ω–∞—Ü–µ–Ω–∫–∞ √ó3 –Ω–∞ —Å—Ç–æ–∏–º–æ—Å—Ç—å —Ç–æ–∫–µ–Ω–æ–≤ Claude
3. **–°–µ—Å—Å–∏–∏** ‚Äî –∏—Å—Ç–æ—Ä–∏—è —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –º–µ–∂–¥—É —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º–∏
4. **–î–≤–∞ —Ä–µ–∂–∏–º–∞** ‚Äî seller.ozon.ru (—Å–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ) –∏ ozon.ru (–∫–æ–Ω–∫—É—Ä–µ–Ω—Ç—ã)

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
ozon-analytics-assistant/
‚îú‚îÄ‚îÄ server/                    # –ë—ç–∫–µ–Ω–¥ (Node.js + Express + TypeScript)
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ index.ts          # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ routes/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.ts       # –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è, –ª–æ–≥–∏–Ω, API –∫–ª—é—á–∏
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ chat.ts       # –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π, –∏—Å—Ç–æ—Ä–∏—è
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ billing.ts    # –ë–∞–ª–∞–Ω—Å, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ claude.ts     # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Claude API
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ middleware/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.ts       # JWT + API key –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ errorHandler.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ prisma.ts     # –ö–ª–∏–µ–Ω—Ç –ë–î
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ apiKey.ts     # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è/—Ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–ª—é—á–µ–π
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ types/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ index.ts      # TypeScript —Ç–∏–ø—ã
‚îÇ   ‚îú‚îÄ‚îÄ prisma/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ schema.prisma     # –°—Ö–µ–º–∞ –ë–î
‚îÇ   ‚îú‚îÄ‚îÄ package.json
‚îÇ   ‚îú‚îÄ‚îÄ tsconfig.json
‚îÇ   ‚îî‚îÄ‚îÄ .env.example
‚îÇ
‚îú‚îÄ‚îÄ manifest.json             # Chrome —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ
‚îú‚îÄ‚îÄ content.js                # –°–∫—Ä–∏–ø—Ç –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ Ozon
‚îú‚îÄ‚îÄ background.js             # Service worker (–ù–£–ñ–ù–û –û–ë–ù–û–í–ò–¢–¨!)
‚îú‚îÄ‚îÄ styles.css                # –°—Ç–∏–ª–∏ UI
‚îú‚îÄ‚îÄ popup.html/js             # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
‚îú‚îÄ‚îÄ icons/
‚îÇ
‚îú‚îÄ‚îÄ TECHNICAL_SPEC.md         # –ü–æ–ª–Ω–æ–µ –¢–ó
‚îú‚îÄ‚îÄ DEVELOPMENT.md            # ‚Üê –í–´ –ó–î–ï–°–¨
‚îî‚îÄ‚îÄ README.md                 # –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```

---

## –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### –¢–∞–±–ª–∏—Ü—ã

**users** ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
- `id`, `email`, `passwordHash`, `apiKeyHash`, `balance`, `isBlocked`

**sessions** ‚Äî —Å–µ—Å—Å–∏–∏ —á–∞—Ç–∞
- `id`, `userId`, `domain` (seller.ozon.ru / ozon.ru), `isActive`

**messages** ‚Äî —Å–æ–æ–±—â–µ–Ω–∏—è
- `id`, `sessionId`, `role`, `content`, `pageData`, `inputTokens`, `outputTokens`, `cost`

**transactions** ‚Äî –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è/—Å–ø–∏—Å–∞–Ω–∏—è
- `id`, `userId`, `type` (topup/usage), `amount`, `description`

---

## API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

### –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
```
POST /api/auth/register   { email, password }
POST /api/auth/login      { email, password }
POST /api/auth/api-key    [JWT] ‚Üí –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç API –∫–ª—é—á
GET  /api/auth/me         [JWT] ‚Üí –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```

### –ß–∞—Ç
```
POST /api/chat/message    [API-KEY] { message, pageData, sessionId? }
GET  /api/chat/sessions   [API-KEY] ‚Üí —Å–ø–∏—Å–æ–∫ —Å–µ—Å—Å–∏–π
GET  /api/chat/history/:id [API-KEY] ‚Üí –∏—Å—Ç–æ—Ä–∏—è —Å–µ—Å—Å–∏–∏
DELETE /api/chat/session/:id [API-KEY]
```

### –ë–∏–ª–ª–∏–Ω–≥
```
GET  /api/billing/balance  [API-KEY] ‚Üí —Ç–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å
GET  /api/billing/usage    [API-KEY] ‚Üí –∏—Å—Ç–æ—Ä–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
GET  /api/billing/stats    [JWT] ‚Üí –¥–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
POST /api/billing/topup    [JWT] ‚Üí –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ (–∑–∞–≥–ª—É—à–∫–∞)
```

---

## –¶–µ–Ω–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ

### –°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å (Claude Sonnet)
- Input: $3 / 1M —Ç–æ–∫–µ–Ω–æ–≤
- Output: $15 / 1M —Ç–æ–∫–µ–Ω–æ–≤

### –¶–µ–Ω–∞ –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞ (√ó3)
- Input: $9 / 1M —Ç–æ–∫–µ–Ω–æ–≤
- Output: $45 / 1M —Ç–æ–∫–µ–Ω–æ–≤

### –ü—Ä–∏–º–µ—Ä —Ä–∞—Å—á—ë—Ç–∞
–ó–∞–ø—Ä–æ—Å 1000 input + 500 output —Ç–æ–∫–µ–Ω–æ–≤:
- –°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å: (1000/1M √ó $3) + (500/1M √ó $15) = $0.0105
- –î–ª—è –∫–ª–∏–µ–Ω—Ç–∞: $0.0105 √ó 3 = $0.0315

---

## –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### ‚úÖ –ì–æ—Ç–æ–≤–æ (MVP)
- [x] –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±—ç–∫–µ–Ω–¥–∞ (Express + TypeScript)
- [x] Prisma —Å—Ö–µ–º–∞ (PostgreSQL)
- [x] API –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (register, login, api-key)
- [x] API —á–∞—Ç–∞ (message, sessions, history)
- [x] API –±–∏–ª–ª–∏–Ω–≥–∞ (balance, usage, stats)
- [x] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Claude API
- [x] Chrome –ø–ª–∞–≥–∏–Ω –æ–±–Ω–æ–≤–ª—ë–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Å–µ—Ä–≤–µ—Ä–æ–º
- [x] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ seller.ozon.ru –∏ ozon.ru
- [x] –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ –≤ –ø–ª–∞–≥–∏–Ω–µ
- [x] –ò—Å—Ç–æ—Ä–∏—è —á–∞—Ç–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –º–µ–∂–¥—É —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º–∏
- [x] –°—Å—ã–ª–∫–∞ –Ω–∞ @first_seller –≤ –ø–ª–∞–≥–∏–Ω–µ

### üìã TODO (—Å–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏)
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å PostgreSQL –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä
- [ ] –°–æ–∑–¥–∞—Ç—å –∏–∫–æ–Ω–∫–∏ –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
- [ ] Prompt caching –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ —Ç–æ–∫–µ–Ω–æ–≤
- [ ] –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å (–≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å)
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –ø–ª–∞—Ç—ë–∂–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã (–ÆKassa)
- [ ] Telegram-–±–æ—Ç –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

---

## –ó–∞–ø—É—Å–∫ –ª–æ–∫–∞–ª—å–Ω–æ

### –ë—ç–∫–µ–Ω–¥
```bash
cd server
npm install
cp .env.example .env
# –ó–∞–ø–æ–ª–Ω–∏—Ç—å .env (DATABASE_URL, ANTHROPIC_API_KEY, JWT_SECRET)
npx prisma generate
npx prisma db push
npm run dev
```

### –ü–ª–∞–≥–∏–Ω
1. –û—Ç–∫—Ä—ã—Ç—å chrome://extensions/
2. –í–∫–ª—é—á–∏—Ç—å "–†–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞"
3. "–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ä–∞—Å–ø–∞–∫–æ–≤–∞–Ω–Ω–æ–µ" ‚Üí –≤—ã–±—Ä–∞—Ç—å –ø–∞–ø–∫—É ozon-analytics-assistant

---

## –í–∞–∂–Ω—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

| –ß—Ç–æ –º–µ–Ω—è—Ç—å | –§–∞–π–ª |
|------------|------|
| –°—Ö–µ–º–∞ –ë–î | `server/prisma/schema.prisma` |
| API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã | `server/src/routes/*.ts` |
| –õ–æ–≥–∏–∫–∞ Claude | `server/src/services/claude.ts` |
| –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è | `server/src/middleware/auth.ts` |
| UI –ø–ª–∞–≥–∏–Ω–∞ | `content.js`, `styles.css` |
| –ö–æ–Ω—Ñ–∏–≥ –ø–ª–∞–≥–∏–Ω–∞ | `manifest.json` |

---

## –ö–æ–Ω—Ç–∞–∫—Ç—ã

- **Telegram –∫–∞–Ω–∞–ª:** @first_seller
- **–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫:** @first_seller

---

## Changelog

### 2026-02-05 (v1.1.0)
**–ë—ç–∫–µ–Ω–¥:**
- –°–æ–∑–¥–∞–Ω –±—ç–∫–µ–Ω–¥ (Node.js + Express + TypeScript)
- –ù–∞—Å—Ç—Ä–æ–µ–Ω–∞ Prisma —Å PostgreSQL
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã API: auth, chat, billing
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Claude API (Sonnet)
- –ù–∞—Ü–µ–Ω–∫–∞ √ó3 –Ω–∞ —Å—Ç–æ–∏–º–æ—Å—Ç—å —Ç–æ–∫–µ–Ω–æ–≤

**–ü–ª–∞–≥–∏–Ω:**
- –û–±–Ω–æ–≤–ª—ë–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Å–µ—Ä–≤–µ—Ä–æ–º (–Ω–µ –Ω–∞–ø—Ä—è–º—É—é —Å Claude)
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ ozon.ru (–∞–Ω–∞–ª–∏–∑ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤)
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ –≤ —à–∞–ø–∫–µ —á–∞—Ç–∞
- –ò—Å—Ç–æ—Ä–∏—è —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –º–µ–∂–¥—É —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º–∏
- –ö–Ω–æ–ø–∫–∞ "–û—á–∏—Å—Ç–∏—Ç—å" –¥–ª—è –Ω–æ–≤–æ–π —Å–µ—Å—Å–∏–∏
- –°—Å—ã–ª–∫–∞ –Ω–∞ @first_seller

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
- TECHNICAL_SPEC.md ‚Äî –ø–æ–ª–Ω–æ–µ –¢–ó
- DEVELOPMENT.md ‚Äî –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
